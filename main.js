(()=>{"use strict";class e{constructor(e,t,s){this._name=e.name,this._image=e.image,this._template=t,this.handleCardClick=s}_getTempalte(){return this._template.content.querySelector(".element").cloneNode(!0)}_setEventListeners(){this._elementCard.querySelector(".element__like-button").addEventListener("click",this._handleLike),this._elementCard.querySelector(".element__delete-button").addEventListener("click",this._handleDelete),this._cardImage.addEventListener("click",(()=>{this.handleCardClick()}))}_handleLike=e=>{e.target.classList.toggle("element__like-button_acive")};_handleDelete=()=>{this._elementCard.remove()};createCard=()=>(this._elementCard=this._getTempalte(),this._cardImage=this._elementCard.querySelector(".element__pic"),this._cardName=this._elementCard.querySelector(".element__name"),this._setEventListeners(),this._cardName.textContent=this._name,this._cardImage.src=this._image,this._cardImage.alt=this._name,this._elementCard)}const t={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button-save",inactiveButtonClass:"popup__button-save_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_activate"};class s{constructor(e,t){this._formElement=t,this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputList=[...t.querySelectorAll(this._inputSelector)],this._buttonElement=t.querySelector(this._submitButtonSelector)}_showInputError(e,t){const s=this._formElement.querySelector(`.popup__input-error_${e.id}`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`.popup__input-error_${e.id}`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._inactiveButtonClass)):(this._buttonElement.disabled=!1,this._buttonElement.classList.remove(this._inactiveButtonClass))}_setEventListeners=()=>{this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))};enableValidation=()=>{this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()};resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}class n{constructor(e){this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_is-opened"),document.addEventListener("keydown",this._handleEscClose),this._popup.addEventListener("click",this._handleOverlayClose)}close(){this._popup.classList.remove("popup_is-opened"),document.removeEventListener("keydown",this._handleEscClose),this._popup.removeEventListener("click",this._handleOverlayClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleOverlayClose=e=>{e.target===e.currentTarget&&this.close()};setEventListeners(){this._popup.querySelector(".popup__button-close").addEventListener("click",(()=>{this.close()}))}}class r extends n{constructor(e,t){super(e),this._submiter=t,this._form=this._popup.querySelector(".popup__form"),this._inputList=[...this._popup.querySelectorAll(".popup__input")]}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>this._formValues[e.name]=e.value)),this._formValues}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(()=>{this._submiter(this._getInputValues()),this.close()}))}close(){super.close(),this._form.reset()}}const i=document.querySelector(".profile__edit-button"),o=document.forms["form-edit"],a=document.forms["form-card"],p=o.querySelector(".popup__input_type_name"),l=o.querySelector(".popup__input_type_description"),c=document.querySelector(".elements"),_=document.querySelector(".element-template"),u=document.querySelector(".profile__add-button"),d=new class{constructor({name:e,description:t}){this._name=document.querySelector(e),this._description=document.querySelector(t)}getUserInfo(){return{name:this._name.textContent,description:this._description.textContent}}setUserInfo({fullname:e,description:t}){this._name.textContent=e,this._description.textContent=t}}({name:".profile__name",description:".profile__description"}),h=new r(".popup_type_edit",(e=>{d.setUserInfo(e)}));h.setEventListeners();const m=new s(t,o);m.enableValidation(),i.addEventListener("click",(function(){h.open();const e=d.getUserInfo();p.value=e.name,l.value=e.description,m.resetValidation()}));const v=new class extends n{constructor(e){super(e),this._title=this._popup.querySelector(".popup__title-pic"),this._link=this._popup.querySelector(".popup__pic")}open({name:e,image:t}){super.open(),this._title.textContent=e,this._link.src=t,this._title.alt=e}}(".popup_type_pic");function E(t,s){return new e(t,s,(()=>{v.open(t)})).createCard()}v.setEventListeners();const y=new class{constructor({items:e,renderer:t},s){this._renderer=t,this._renderedItems=e,this._container=s}renderItems(){this._renderedItems.forEach((e=>this._renderer(e)))}addItem(e){this._container.prepend(e)}}({items:[{name:"Архыз",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{const t=E(e,_);y.addItem(t)}},c);y.renderItems();const C=new s(t,a);C.enableValidation();const f=new r(".popup_type_card",(e=>{const t=E(e,_);y.addItem(t)}));f.setEventListeners(),u.addEventListener("click",(function(){f.open(),C.resetValidation()}))})();